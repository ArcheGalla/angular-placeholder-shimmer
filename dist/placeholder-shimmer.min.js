angular.module("ngPlaceholderShimmer",[]).provider("psConfig",function(){this.color="#E6E6E6",this.hgcolor="#F2F2F2",this.timeout=60,this.$get=function(){return this}}).service("psService",["$timeout",function(e){this.process,this.close=function(){if(!this.process)throw new Error("none process to close")
e.cancel(this.process)}}]).factory("psFactory",["psConfig",function(e){return{createGradient:function(t,r,n){var o=t.createLinearGradient(r,0,2*r,0)
return o.addColorStop(n[0],e.hgcolor),o.addColorStop(n[1],e.color),o},getOffsetLeft:function(e){function t(e){r+=e.offsetLeft,e.offsetParent&&t(e.offsetParent)}var r=0
return t(e),r}}}]).controller("psCtrl",["psConfig","psService","$scope",function(e,t,r){r.color=e.color,r.hgcolor=e.hgcolor,r.current=0,r.max=0,r.order=r._order=[0,1],r.$on("$destroy",function(){t.close()})}]).directive("placeholderShimmer",["psConfig","psFactory","psService","$interval","$timeout",function(e,t,r,n,o){return{controller:"psCtrl",restrict:"E",scope:{},link:function(c,i){function a(){var e=Math.floor(c.max/30)
return n(function(){c.current=c.current+30,c.$parent.$broadcast("placeholder-shimmer-gradient-up",{current:c.current,max:c.max,order:c.order,increment:30})},10,e)}function s(){c.$parent.$broadcast("placeholder-shimmer-gradient-reset"),c.current=0,c.order.reverse()}function l(){a().then(function(){s(),a().then(function(){s(),r.process=o(function(){l()},2e3)})})}var f=angular.element(i).find("canvas"),u=[]
for(var d in f)if(f.hasOwnProperty(d)&&angular.isDefined(d)&&!isNaN(parseInt(d))){var h=f[d],p=t.getOffsetLeft(f[d])
u.push(p+2*h.clientWidth)}u.sort(function(e,t){return t-e}),c.max=u[0],l(),o(function(){r.close()},1e3*e.timeout)}}}]).directive("psText",function(e,t){return{require:"^placeholderShimmer",controller:"psCtrl",restrict:"E",scope:{width:"@",lines:"@",lineSize:"@?"},template:'<canvas style="vertical-align: top; margin: 5px;"></canvas>',link:function(r,n){function o(n){r.ctx.fillStyle=1==n?e.color:t.createGradient(r.ctx,r.current,r.order),r.coord.forEach(function(e){r.ctx.fillRect(e.x,e.y,e.w,e.h)})}r.$on("placeholder-shimmer-gradient-up",function(e,t){t.current>r.offsetLeft&&(r.current=r.current+t.increment,r.order=t.order,o())}),r.$on("placeholder-shimmer-gradient-reset",function(e){r.current=0})
var c=r.lineSize||12,i=angular.element(n).find("canvas")
i.attr("width",r.width),i.attr("height",r.lines*(2*c))
var a=angular.element(n).find("canvas")[0]
if(!a.getContext)throw new Error("canvas not supported")
r.offsetLeft=t.getOffsetLeft(a),r.ctx=a.getContext("2d"),r.ctx.beginPath(),r.coord=[]
for(var s=0;s<r.lines;s++){var l=Math.floor(Math.random()*(10*r.width/100))
r.coord.push({x:0,y:2*c*s,w:r.width-l,h:c})}o(!0)}}}).directive("psCircle",["psConfig","psFactory",function(e,t){return{require:"^placeholderShimmer",controller:"psCtrl",restrict:"E",scope:{size:"@"},template:'<canvas style="vertical-align: top;"></canvas>',link:function(r,n){function o(n){1==n?(r.ctx.strokeStyle=e.color,r.ctx.fillStyle=e.color):(r.ctx.strokeStyle=t.createGradient(r.ctx,r.current,r.order),r.ctx.fillStyle=t.createGradient(r.ctx,r.current,r.order)),r.ctx.arc(r.a,r.b,r.c,0,2*Math.PI,!1),r.ctx.fill(),r.ctx.stroke()}r.$on("placeholder-shimmer-gradient-up",function(e,t){t.current>r.offsetLeft&&(r.current=r.current+t.increment,r.order=t.order,o())}),r.$on("placeholder-shimmer-gradient-reset",function(e){r.current=0})
var c=angular.element(n).find("canvas")
switch(r.size){case"s":r.a=25,r.b=25,r.c=20,r.w=50,r.h=50
break
case"m":r.a=50,r.b=50,r.c=40,r.w=100,r.h=100
break
case"l":r.a=75,r.b=75,r.c=60,r.w=150,r.h=150
break
default:throw new Error("unknow size")}c.attr("width",r.w),c.attr("height",r.h)
var i=angular.element(n).find("canvas")[0]
if(!i.getContext)throw new Error("canvas not supported")
r.offsetLeft=t.getOffsetLeft(i),r.ctx=i.getContext("2d"),r.ctx.beginPath(),r.ctx.lineWidth=1,o(!0)}}}]).directive("psSquare",["psConfig","psFactory",function(e,t){return{require:"^placeholderShimmer",controller:"psCtrl",restrict:"E",scope:{size:"@"},template:'<canvas style="vertical-align: top; padding: 5px;"></canvas>',link:function(r,n){function o(n){r.ctx.fillStyle=1==n?e.color:t.createGradient(r.ctx,r.current,r.order),r.ctx.fillRect(0,0,r.h,r.h)}r.$on("placeholder-shimmer-gradient-up",function(e,t){t.current>r.offsetLeft&&(r.current=r.current+t.increment,r.order=t.order,o())}),r.$on("placeholder-shimmer-gradient-reset",function(e){r.current=0})
var c=angular.element(n).find("canvas")
switch(r.size){case"s":r.h=50
break
case"m":r.h=100
break
case"l":r.h=150
break
default:throw new Error("unknow size")}c.attr("width",r.h),c.attr("height",r.h)
var i=angular.element(n).find("canvas")[0]
if(!i.getContext)throw new Error("canvas not supported")
r.offsetLeft=t.getOffsetLeft(i),r.ctx=i.getContext("2d"),o(!0)}}}]).directive("psRectangle",["psConfig","psFactory",function(e,t){return{require:"^placeholderShimmer",controller:"psCtrl",restrict:"E",scope:{width:"@",height:"@"},template:'<canvas style="vertical-align: top; padding: 5px;"></canvas>',link:function(r,n){function o(n){r.ctx.fillStyle=1==n?e.color:t.createGradient(r.ctx,r.current,r.order),r.ctx.fillRect(0,0,r.width,r.height)}r.$on("placeholder-shimmer-gradient-up",function(e,t){t.current>r.offsetLeft&&(r.current=r.current+t.increment,r.order=t.order,o())}),r.$on("placeholder-shimmer-gradient-reset",function(e){r.current=0})
var c=angular.element(n).find("canvas")
c.attr("width",r.width),c.attr("height",r.height)
var i=angular.element(n).find("canvas")[0]
if(!i.getContext)throw new Error("canvas not supported")
r.offsetLeft=t.getOffsetLeft(i),r.ctx=i.getContext("2d"),o(!0)}}}])
